# 議事録：Google Chat ログ外部出力に関する技術検討と方針決定

**作成日:** 2026年2月26日
**テーマ:** Google Chatの会話ログを外部（テキストファイル等）に自動出力するためのシステム構成と実現方法の検討

---

## 1. 背景と目的
Google Chat上で行われている会話のログを外部システムまたはファイルとして出力・保存する。
具体的な要件として、以下の2点が挙げられた。

* **要件1:** 指定した「特定ユーザー」の1日の発言（スレッド起点・リプライ問わず）を、参加スペースやDMを横断してすべてテキスト出力する。
* **要件2:** 「特定のチャットスペース」の1日の会話すべてを、スレッドや引用といった会話の構造を維持した状態でテキスト出力する。

## 2. 検討プロセス（技術的アプローチの比較）

上記2つの要件について、Googleが提供するAPIの仕様に基づき実現可能性とアプローチを検討した。結論として、要件によって使用すべきAPIとシステム構成が全く異なることが判明した。

### 要件1（特定ユーザーの横断的ログ抽出）に対する検討
* **課題:** 開発者向けの標準機能（Google Chat API）は「特定のスペース内」の取得を前提としており、ユーザー単位で全スペース・DMを横断検索する機能を持たない。
* **解決策:** 管理者向けの監査機能である **Google Vault API** を使用する。
* **懸念事項:** * 実行環境にGoogle Workspaceの「Vault管理者」等の強力な権限が必要。
    * 出力されるデータが監査用の複雑なフォーマット（MBOX/XML等）となるため、発言内容だけを綺麗に抽出する（パース処理）開発難易度が比較的高い。

### 要件2（特定スペースの構造化ログ抽出）に対する検討
* **課題:** スレッドやリプライ、引用などの会話構造をどのように維持してテキスト化するか。
* **解決策:** **Google Chat API と Google Apps Script (GAS)** を組み合わせて使用する。
* **技術的根拠:** * Chat APIから取得できるJSONデータには、スレッド情報（`thread.name`）やタイムスタンプ（`createTime`）、書式情報が構造化されて含まれているため、プログラム上でグループ化やソート処理を行えば、構造を維持したテキストファイルの生成が十分に可能。
* **懸念事項:** Google Cloud プロジェクト上でのAPI有効化や、OAuth/サービスアカウント等の適切な認証設定（初期設定）が必要。

## 3. 結論とネクストアクション

要件1と要件2は、必要となる権限レベルや使用するAPIが異なるため、**それぞれ独立したシステムとして設計・開発を進める**方針とする。（※設計仕様書は別途作成済み）

**【推奨される進め方】**
管理者権限の調整や複雑なパース処理が不要で、GASのみで比較的シンプルに構築できる **「要件2（特定スペースの構造化ログ抽出）」のプロトタイプ開発と技術検証から優先して着手する** ことが望ましい。

---
