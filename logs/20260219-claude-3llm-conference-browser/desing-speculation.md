# 設計仕様書：LLM Conference（仮称）

## 1. 概要

### 1.1 プロダクトビジョン

複数のLLMチャットサービスと同時に対話し、LLM同士の意見を交差させながら議論を進めることができるデスクトップアプリケーション。ユーザーは司会者として3つのLLMと「会議」を行い、最終的に議事録として成果を出力できる。

### 1.2 技術スタック

|項目        |技術                                              |
|----------|------------------------------------------------|
|アプリケーション基盤|Electron                                        |
|LLM表示方式   |BrowserView / WebView（各LLMサービスのWebインターフェースを直接表示）|
|フロントエンド   |HTML / CSS / JavaScript（React等のフレームワークは要検討）     |
|データ保存     |ローカルファイル（JSON / SQLite）                         |

-----

## 2. 画面構成

### 2.1 全体レイアウト

```
┌──────────────┬──────────────┬──────────────┬──────────────┐
│              │              │              │              │
│    タブ1     │    タブ2     │    タブ3     │    タブ4     │
│  入力パネル   │   LLM-A     │   LLM-B     │   LLM-C     │
│              │              │              │              │
│  ┌────────┐ │  (例:Claude) │ (例:ChatGPT) │ (例:Gemini)  │
│  │入力欄1 │ │              │              │              │
│  │[一斉]  │ │              │              │              │
│  │☐クロス │ │              │              │              │
│  ├────────┤ │              │              │              │
│  │入力欄2 │ │              │              │              │
│  │[→タブ2]│ │              │              │              │
│  ├────────┤ │              │              │              │
│  │入力欄3 │ │              │              │              │
│  │[→タブ3]│ │              │              │              │
│  ├────────┤ │              │              │              │
│  │入力欄4 │ │              │              │              │
│  │[→タブ4]│ │              │              │              │
│  └────────┘ │              │              │              │
│              │              │              │              │
│ [議事録生成]  │              │              │              │
└──────────────┴──────────────┴──────────────┴──────────────┘
```

- ウィンドウは4ペインに分割（リサイズ可能）
- タブ1（左端）：入力パネル（常時表示）
- タブ2〜4：各LLMチャットサービスのWebView

### 2.2 タブ1 入力パネル詳細

#### 入力欄1（一斉送信）

- テキスト入力エリア＋送信ボタン
- 送信するとタブ2〜4の全LLMに同一内容を入力・送信
- **クロス送信オプション**（チェックボックス）
  - OFF（デフォルト）：入力テキストのみを各LLMに送信
  - ON：入力テキスト＋他LLMの最新回答を構造化して送信

#### 入力欄2〜4（個別送信）

- 各入力欄はそれぞれタブ2〜4に対応
- 送信すると対応するLLMにのみ入力・送信

#### 議事録生成ボタン

- パネル下部に配置
- 押下で議事録生成フローを開始

-----

## 3. 機能仕様

### 3.1 一斉送信機能

**トリガー**: 入力欄1の送信ボタン押下

**処理フロー**:

1. 入力欄1のテキストを取得
1. タブ2〜4の各WebViewに対してテキストを入力
1. 各WebViewで送信を実行
1. 会話ログに記録（発言者：ユーザー、送信先：全体）

### 3.2 個別送信機能

**トリガー**: 入力欄2〜4の送信ボタン押下

**処理フロー**:

1. 該当入力欄のテキストを取得
1. 対応するタブのWebViewにテキストを入力
1. WebViewで送信を実行
1. 会話ログに記録（発言者：ユーザー、送信先：対応LLM名）

### 3.3 クロス送信機能

**トリガー**: クロス送信オプションONの状態で入力欄1の送信ボタン押下

**処理フロー**:

1. 入力欄1のテキストを取得
1. タブ2〜4それぞれから最新の回答テキストを取得（DOMスクレイピング）
1. 各LLM向けに送信テキストを構成：

```
【あなたへの質問】
{ユーザーの入力テキスト}

【他の参加者の意見】
■ {LLM-Bの名前}の回答：
{LLM-Bの最新回答テキスト}

■ {LLM-Cの名前}の回答：
{LLM-Cの最新回答テキスト}
```

1. 各WebViewに構成済みテキストを入力・送信
1. 会話ログに記録（発言者：ユーザー、送信先：全体、クロス送信フラグ：ON）

**検討事項**:

- 回答テキストが長い場合の処理（全文送信 / 先頭N文字で切り詰め / 要約生成）
- 要約する場合の要約手段（クライアント側LLM呼び出し or 簡易的なトリミング）

### 3.4 会話ログ記録機能

**記録対象**:

- ユーザーの全送信内容（送信先、クロス送信の有無を含む）
- 各LLMの全回答テキスト（タイムスタンプ付き）

**記録形式**:

```json
{
  "session_id": "uuid",
  "started_at": "2026-02-20T14:00:00+09:00",
  "participants": [
    { "role": "user", "name": "ユーザー" },
    { "role": "llm", "name": "Claude", "tab": 2, "service_url": "https://claude.ai" },
    { "role": "llm", "name": "ChatGPT", "tab": 3, "service_url": "https://chatgpt.com" },
    { "role": "llm", "name": "Gemini", "tab": 4, "service_url": "https://gemini.google.com" }
  ],
  "messages": [
    {
      "timestamp": "2026-02-20T14:01:00+09:00",
      "sender": "user",
      "target": "all",
      "cross_send": false,
      "content": "この設計についてどう思いますか？"
    },
    {
      "timestamp": "2026-02-20T14:01:15+09:00",
      "sender": "Claude",
      "target": null,
      "content": "..."
    }
  ]
}
```

**保存先**: ローカルストレージ（アプリ内データディレクトリ）

### 3.5 議事録生成機能

**トリガー**: 議事録生成ボタン押下

**処理フロー**:

1. 現在のセッションの全会話ログを取得
1. ユーザーに生成オプションを提示：
- 生成に使用するLLMの選択（タブ2〜4のいずれか、または外部API）
- 出力形式の選択（Markdown / PDF）
1. 選択されたLLMに全ログ＋議事録生成プロンプトを送信
1. 生成結果をプレビュー表示
1. ユーザー確認後、指定形式でファイルエクスポート

**議事録テンプレート（生成プロンプトで指示する構造）**:

```markdown
# 会議議事録
## 基本情報（日時、参加者）
## 議題
## 議論の経緯
## 各参加者の主な主張
## 合意事項
## 未解決事項・ネクストアクション
```

-----

## 4. LLMサービス連携

### 4.1 対応方式

各LLMサービスのWebインターフェースをElectronのBrowserViewで表示し、DOM操作によりテキスト入力・送信を行う。

### 4.2 必要なDOM操作

|操作    |内容                                 |
|------|-----------------------------------|
|テキスト入力|チャット入力欄のDOM要素を特定し、テキストを挿入          |
|送信    |送信ボタンのクリックイベントを発火、またはEnterキーイベントを送信|
|回答取得  |最新の回答要素からテキストを抽出                   |

### 4.3 リスク・制約

- 各サービスのDOM構造変更により動作しなくなる可能性がある
- ログイン認証はユーザーが各WebView内で手動で行う
- サービスごとにDOM操作のセレクタ定義が必要（設定ファイルで管理し更新可能にする）

-----

## 5. 設定機能

### 5.1 LLMサービス設定

- タブ2〜4それぞれに割り当てるLLMサービスのURL
- 各サービスの表示名（会話ログ・議事録に使用）
- DOM操作用セレクタ定義（入力欄、送信ボタン、回答エリア）

### 5.2 クロス送信設定

- 回答テキストの最大文字数（0 = 無制限）
- 送信フォーマットのカスタマイズ

### 5.3 議事録設定

- デフォルト出力形式（Markdown / PDF）
- デフォルト保存先ディレクトリ

-----

## 6. 今後の拡張候補

- ペイン数の可変化（3ペイン〜5ペイン対応）
- API連携モード（WebView表示ではなくAPI経由で各LLMと通信）
- 会議テンプレート機能（ブレスト、意思決定、レビューなど用途別プロンプト）
- セッション履歴管理（過去の会議一覧・検索・再開）
- 音声入力対応
- リアルタイム要約パネル（会議中に議論のサマリーを常時表示）

-----

*本仕様書は構想段階のものであり、実装時に詳細な技術検証・設計調整が必要である。*